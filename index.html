<!DOCTYPE html>
<html>
<head>
    <title>Mis Tareas</title>
    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBNEQqC00bAupyv6L_lDJDvvi8vDGU3rO0",
            authDomain: "tasks-dfce4.firebaseapp.com",
            projectId: "tasks-dfce4",
            storageBucket: "tasks-dfce4.firebasestorage.app",
            messagingSenderId: "1010889254813",
            appId: "1:1010889254813:web:bbcb772c978c94816a3174"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Función de login
        window.checkPassword = async () => {
            const password = document.getElementById('password').value;
            const errorElement = document.getElementById('error');

            try {
                // Usuario fijo (cámbialo si quieres)
                await signInWithEmailAndPassword(auth, 'usuario@tareas.com', password);

                // Si la autenticación es exitosa, cargamos la aplicación
                loadApp();
            } catch (error) {
                errorElement.textContent = 'Contraseña incorrecta';
                errorElement.classList.remove('hidden');
            }
        };

        // Cargar la aplicación después de autenticarse
        async function loadApp() {
            // Hide login form
            document.getElementById('login').classList.add('hidden');

            // Inject the app HTML structure
            document.body.innerHTML += `
            <div class="container">
                <h1>Mis Tareas ✅</h1>
                <div class="new-task">
                    <input type="text" id="taskInput" placeholder="Nueva tarea">
                    <select id="category">
                        <option value="Personal">Personal</option>
                        <option value="Trabajo">Trabajo</option>
                        <option value="Estudio">Estudio</option>
                    </select>
                    <button onclick="addTask()">Agregar</button>
                </div>
                <div id="tasks"></div>
            </div>
        `;

            // Load CSS
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = 'style.css';
            document.head.appendChild(link);

            // Load app.js
            const script = document.createElement('script');
            script.src = 'app.js';
            document.body.appendChild(script);
        }
    </script>
</head>
<body>
    <!-- Solo muestra el formulario de login -->
    <div id="login" class="login-container">
        <input type="password" id="password" placeholder="Contraseña">
        <button onclick="checkPassword()">Entrar</button>
        <p id="error" class="error hidden"></p>
    </div>
</body>
</html>